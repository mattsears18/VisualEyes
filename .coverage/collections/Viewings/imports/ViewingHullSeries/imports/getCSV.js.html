<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for collections/Viewings/imports/ViewingHullSeries/imports/getCSV.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="/Users/mattsears/code/VisualEyes/.coverage/prettify.css" />
    <link rel="stylesheet" href="/Users/mattsears/code/VisualEyes/.coverage/base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(/Users/mattsears/code/VisualEyes/.coverage/sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="/Users/mattsears/code/VisualEyes/.coverage/index.html">All files</a> collections/Viewings/imports/ViewingHullSeries/imports/getCSV.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">80% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>16/20</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">66.67% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>4/6</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">100% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>2/2</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">77.78% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>14/18</span>
      </div>
    </div>
    <p class="quiet">
      Press <em>n</em> or <em>j</em> to go to the next uncovered block, <em>b</em>, <em>p</em> or <em>k</em> for the previous block.
    </p>
  </div>
  <div class='status-line high'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80</td><td class="line-coverage quiet"><span class="cline-any cline-yes">4x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-yes">9x</span>
<span class="cline-any cline-yes">9x</span>
<span class="cline-any cline-yes">9x</span>
<span class="cline-any cline-yes">9x</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">10x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1x</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">const json2csv = require('json2csv').parse
&nbsp;
export default function getCSV() {
  let data = []
  let hulls = this.getHulls()
&nbsp;
  hulls.forEach((hull, hi) =&gt; {
    let hullData = {
      link: Meteor.absoluteUrl() + 'studies/' + this.viewing.analysis().study()._id + '/viewings/' + this.viewing._id,
      study: this.viewing.study().name,
      analysis: this.viewing.analysis().name,
      viewingGap: this.viewing.analysis().viewingGap,
      minViewingTime: this.viewing.analysis().minViewingTime,
      period: this.period,
      participant: this.viewing.participant().name,
      stimulus: this.viewing.stimulus().name,
      viewingNumber: this.viewing.number,
      viewingDuration: this.viewing.duration,
      stimulusWidth: this.viewing.stimulus().width,
      stimulusHeight: this.viewing.stimulus().height,
      stimulusArea: this.viewing.stimulus().area(),
      hullNumber: hull.number,
      startIndex: hull.startIndex,
      endIndex: hull.endIndex,
      startTime: hull.startTime(),
      endTime: hull.endTime(),
      startTimeNormalized: hull.startTime({ normalized: true }),
      endTimeNormalized: hull.endTime({ normalized: true }),
      hullPeriod: hull.period(),
      timestep: hull.timestep(),
      duration: hull.duration(),
      pointCount: hull.getPoints().length,
      // pointsX: hull.getPoints('x'),
      // pointsY: hull.getPoints('y'),
      lastPointX: hull.lastPoint().x,
      lastPointY: hull.lastPoint().y,
      distance: hull.distance(),
      distanceX: hull.distance('x'),
      distanceY: hull.distance('y'),
      velocity: hull.velocity(),
      velocityX: hull.velocity('x'),
      velocityY: hull.velocity('y'),
      centroidX: hull.centroid().x,
      centroidY: hull.centroid().y,
      centroidDistance: 0,
      centroidDistanceX: 0,
      centroidDistanceY: 0,
      centroidVelocity: 0,
      centroidVelocityX: 0,
      centroidVelocityY: 0,
      coverage: hull.coverage({ width: this.viewing.stimulus().width, height: this.viewing.stimulus().height }),
      coverageDuration: hull.coverageDuration({ width: this.viewing.stimulus().width, height: this.viewing.stimulus().height }),
      averageCoverage: this.getAverageCoverage(),
    }
&nbsp;
    if(hi &gt; 0) {
      hullData.centroidDistanceX = (hulls[hi].centroid({}).x - hulls[hi - 1].centroid({}).x)
      hullData.centroidDistanceY = (hulls[hi].centroid({}).y - hulls[hi - 1].centroid({}).y)
      hullData.centroidDistance = Math.sqrt(hullData.centroidDistanceX * hullData.centroidDistanceX + hullData.centroidDistanceY * hullData.centroidDistanceY)
      <span class="missing-if-branch" title="if path not taken" >I</span>if(hullData.timeStep &gt; 0 &amp;&amp; <span class="branch-1 cbranch-no" title="branch not covered" >hullData.centroidDistance &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" >        hullData.centroidVelocity = (hullData.centroidDistance / hullData.timeStep)</span>
<span class="cstat-no" title="statement not covered" >        hullData.centroidVelocityX = (hullData.centroidDistanceX / hullData.timeStep)</span>
<span class="cstat-no" title="statement not covered" >        hullData.centroidVelocityY = (hullData.centroidDistanceY / hullData.timeStep)</span>
      }
    }
&nbsp;
    data.push(hullData)
  })
&nbsp;
  let csv
&nbsp;
  try {
    csv = json2csv(data)
  } catch (err) {
<span class="cstat-no" title="statement not covered" >    console.error(err)</span>
  }
&nbsp;
  return csv
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="https://istanbul.js.org/" target="_blank">istanbul</a> at Wed May 01 2019 10:52:31 GMT-0400 (EDT)
</div>
</div>
<script src="/Users/mattsears/code/VisualEyes/.coverage/prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="/Users/mattsears/code/VisualEyes/.coverage/sorter.js"></script>
<script src="/Users/mattsears/code/VisualEyes/.coverage/block-navigation.js"></script>
</body>
</html>
